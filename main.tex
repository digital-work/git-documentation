\documentclass{article}
\usepackage[utf8]{inputenc}

\title{Git Documentation}
\author{Joschua Thomas Simon-Liedtke (oleaf)}
\date{July 2019}

\begin{document}

\maketitle

\tableofcontents

\section{Introduction}
This document contains some helpful commands that can be used in git.

\section{Setup}

\subsection{General settings}

\subsubsection{Changing the user and their options}

On your PC/Mac:
\begin{verbatim}
git config --global user.email "email@example.com"
got config --global user.name "John Doe"
\end{verbatim}
You can check that everything has been set correctly by typing
\begin{verbatim}
got config --global user.name
\end{verbatim}

On Overleaf:
Go to Account\textgreater  Account Settings and add the email address. Confirm the address by opening the email that you received in your mailbox.
\\

On GitHub:
Go to Settings\textgreater  Emails and add the email address. Confirm the address by opening the email that you received in your mailbox. Choose a primary email address(, which is the one that is going to show up in your commits). OBS: Make sure that you did not mark the "Keep my email address private"-option. The name (that will actually show up in your commits) can be changed in your GitHub profile.

\subsubsection{.gitignore}
In many cases, you will have files in your local repository that you do not want to have committed because they are not useful, they are experimental or too big. In those cases you might want to create a .gitignore file in your folder and commit it to the repository. Git will know automatically that all the fields that are listed in the .gitignore file are not supposed to be tracked for changes.

\subsection{Cross-platform text documents}
In case you want to version control a text document with GitHub, follow this tutorial.

\subsubsection{Starting in Overleaf}
Start in Overleaf, then push it to GitHub, and download from GitHub to your computer
($Overleaf \rightarrow GitHub \rightarrow PC/Mac$).

\begin{enumerate}
    \item Make a new project in Overleaf.
    \item Choose the GitHub option in the menu and choose "Create a GitHub repository". Choose a name and add a description if wanted.
    \item Choose the GitHub option in the menu and choose "Push Overleaf changes to GitHub".
    \item Switch to your GitHub account and check if everything showed up correctly.
    \item Open a terminal on your computer, create and navigate to the folder in which you want to clone the repository.
    \item Obtain the url to the repository on the GitHub page under "Clone or download" and write the following lines in the terminal: 
    \begin{verbatim}
git clone <path/to/github/repository> <folder>
    \end{verbatim}
    (If no folder is specified, it will take the repository name as default name.)
\end{enumerate}

\subsubsection{Starting on GitHub}
Start on GitHub, then pull it from Overleaf and your PC/Mac
($Overleaf \leftarrow GitHub \rightarrow PC/Mac$).

\begin{enumerate}
    \item Make a new repository on GitHub.
    \item Copy the repository address on GitHub.
    \item On your PC/Mac, navigate to the folder where you want to have the repository (or its parent folder).
    \item Clone the GitHub repository into a new folder with the name of the git repository or into a specified folder:
    \begin{verbatim}
git clone <url-to-repository>
git clone <url-to-repository> <path/name/of/folder>
    \end{verbatim}
    \item Get all branches and tags:
    \begin{verbatim}
#git fetch origin
    \end{verbatim}
    \item Check that all branches have been fetched:
    \begin{verbatim}
#git branch -a
    \end{verbatim}
    \item Go to Overleaf and chose "Import from GitHub" under "New Project".
    \item Choose the repository you want to import.
\end{enumerate}

\subsubsection{Starting on your PC/Mac}
Start on your PC/Mac, then push to GitHub, and pull it from GitHub from Overleaf
($PC/Mac \rightarrow GitHub \rightarrow Overleaf$).

\begin{enumerate}
    \item Create a new project on you PC/Mac:
    \begin{verbatim}
git init
    \end{verbatim}
    \item Add files, make changes, commit to local repository.
    \item Create a new and empty repository on GitHub. (No README file!)
    \item Copy repository address.
    \item Navigate to the git repository folder on your computer. 
    \item Remove existing origins from the repository:
    \begin{verbatim}
git remote rm origin
    \end{verbatim}
    \item Add the GitHub repository as a new origin to your local repository on your PC/Mac:
    \begin{verbatim}
git remote add origin <url-to-repository>
    \end{verbatim}
    \item Push all changes from your PC/Mac to GitHub including all branches and flags:
    \begin{verbatim}
git push --all origin
git push --tags origin
    \end{verbatim}
    \item Go to Overleaf and chose "Import from GitHub" under "New Project".
    \item Choose the repository you want to import.
\end{enumerate}

(If you want to migrate a repository from an existing remote to a new remote, checkout the following tutorial: https://gist.github.com/niksumeiko/8972566.)

\section{Maintaining the code}

Before committing new code, always make sure to update your local version from origin first!

\subsubsection{From Overleaf}

\begin{enumerate}
    \item Make your changes and save with Ctrl + s / Cmd + s.
    \item Update your Overleaf repository from origin by choosing the GitHub option in the menu and choosing "Pull GitHub changes into Overleaf".
    \item Choose the GitHub option in the menu and choose "Push Overleaf changes to GitHub". Write a comment and commit.
\end{enumerate}

\subsubsection{From your PC/Mac}
All commands can be done from the command line after navigating to the folder containing the git repository:
\begin{verbatim}
cd <path\to\github\repository>
\end{verbatim}

\begin{enumerate}
    \item Make your changes and save them.
    \item Update your local repository from origin:
	\begin{verbatim}
git pull   
    \end{verbatim}
	\item Stage the file(s) that have changes.
	\begin{verbatim}
git add <name-of-file>
    \end{verbatim}
	\item Commit the changes to the local repository with a change comment:
	\begin{verbatim}
git commit -m "Some useful and readable comment."
    \end{verbatim}
	\item Push the changes to origin.
	\begin{verbatim}
git push
    \end{verbatim}
\end{enumerate}

\section{Branches}

\subsection{General commands}
Make new branch:
\begin{verbatim}
git branch <branch-name>
\end{verbatim}

Delete an existing branch:
\begin{verbatim}
git branch -d <branch-name>
\end{verbatim}

Rename an existing branch (https://multiplestates.wordpress.com/2015/02/05/rename-a-local-and-remote-branch-in-git/):
\begin{enumerate}
    \item Rename the branch in your local repository:
    \begin{verbatim}
git branch -m <old-name> <new-name>
    \end{verbatim}
    \item Push the new branch to remote:
    \begin{verbatim}
git push origin :<old-name> <new-name>
    \end{verbatim}
    \item 
    \begin{verbatim}
git push origin -u <new-name>
    \end{verbatim}
\end{enumerate}

\subsection{Tags}
I know these are not exactly branches but they might work the same way. This section might be moved, if it is getting to big.

Make a new tag:
\begin{emunterate}
    \item
    \begin{verbatim}
git tag <name>
git tag <name> <short-sha>
    \end{verbatim}
    \item
    \begin{verbatim}
git push origin <name>
git push origin --tags
    \end{verbatim}
\end{emunterate}

Delete an existing tag:
\begin{enumerate}
    \item 
    \begin{verbatim}
git tag -d <name>
    \end{verbatim}
    \item
    \begin{verbatim}
git push origin :refs/tags/<name>
    \end{verbatim}
\end{enumerate}

Rename an existing tag (https://stackoverflow.com/questions/1028649/how-do-you-rename-a-git-tag):
\begin{enumerate}
    \item 
    \begin{verbatim}
git tag <new-name> <old-name>
    \end{verbatim}
    \item
    \begin{verbatim}
git tag -d <old-name>
    \end{verbatim}
    \item
    \begin{verbatim}
git push origin :refs/tags/<old-name>
    \end{verbatim}
    \item
    \begin{verbatim}
git push --tags
    \end{verbatim}
\end{enumerate}

Remind all co-workers to run the following command:
\begin{verbatim}
git pull --prune --tags
\end{verbatim}

\subsection{Recurring bugs}

"Git push master fatal: You are not currently on a branch"
Explanation on https://stackoverflow.com/questions/30471557/git-push-master-fatal-you-are-not-currently-on-a-branch/30471627 or https://stackoverflow.com/questions/4735556/git-not-currently-on-any-branch-is-there-an-easy-way-to-get-back-on-a-branch.
General idea:
\begin{verbatim}
git branch <tmp-branch>
git checkout master
git merge <tmp-branch>
git push origin master
\end{verbatim}

\end{document}
